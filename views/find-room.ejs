<%- include( 'partials/header.ejs' ) %>
  <body>
    <!--[if lt IE 7]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <div class="container">
      <div class="logo-container">
        <img src="/images/treasure-dash-logo.svg" alt="Treasure Dash logo" class="logo-container__logo">
        <h1 class="heading-primary heading-primary--logo">Treasure Dash</h1>
      </div>
      <% if (notice) { %>
          <div class="notice notice--error"><%= notice %></div>
      <% } %>
      <div class="block js-enter-name">
        <form action="#" class="single-row-form js-enter-name-form">
          <p>Please enter your name:</p>
          <input class="single-row-form__input js-name-input" type="text" maxlength="14" required>
          <input type="submit" class="button" value="Find a game">
        </form>
      </div>
      <div class="block block--hidden js-rooms-list-block">
        <h2>Rooms</h2>
        <div class="room-list js-rooms-list">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Players</th>
              </tr>
            </thead>
            <tbody>
              <% rooms.sort((a, b) => a.name.localeCompare(b.name)).forEach(function(room) { %>
              <tr>
                <td><a href="/game/<%= room.name.toLowerCase() %>"><%= room.name %></a></td>
                <td><%= room.users.length %></td>
              </tr>
              <% }); %>
            </tbody>
          </table>
        </div>
        <div class="buttons-row clearfix">
          <button class="js-refresh-rooms-btn button button--refresh" aria-label="Refresh" title="Refresh"></button>
          <button class="js-open-modal-btn js-create-room button" data-modal-class=".js-create-room-modal">Create room</button>
        </div>
      </div>
    </div>
    <div class="modal js-create-room-modal">
      <div class="modal__inner">
        <button class="rules__btn rules__btn--close js-close-modal-btn" data-modal-class=".js-create-room-modal">Close</button>
        <h2 class=modal__heading>Create Room</h2>
        <div class='notice notice--error js-error-notice' style="display: none"></div>
        <form action="#" class="single-row-form js-create-room-form">
          <p>Enter your room name:</p>
          <input class="single-row-form__input js-room-name-input" name="room-name" type="text" required>
          <input type="submit" class="button" value="Create">
        </form>
      </div>
    </div>
    <button class="rules__btn js-open-modal-btn" data-modal-class=".js-rules-modal">Rules</button>
    <div class="modal modal--rules js-rules-modal">
      <div class="modal__inner">
        <button class="rules__btn rules__btn--close js-close-modal-btn" data-modal-class=".js-rules-modal">Close</button>
        <h2 class="modal__heading">Rules</h2>
        <p>Treasure Dash is a turn-based game in which the first player to dig up the treasure wins. Once you have found an opponent, you must both pick a starting position. One of you will then be picked at random to go first. When it's your turn, you can choose to either roll or dig. Each time you move, you will find out whether you are close to the treasure. If you are within 2 squares of the treasure in any direction then you will see "warm". You won't find out if you're on top of the treasure unless you dig.</p>
      </div>
    </div>
    <div class="modal__overlay modal__overlay--hidden js-modal-overlay"></div>
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous">
    </script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="scripts/find-room.js" async defer></script>
    <script src="../scripts/handle-modals.js" async defer></script>
  </body>
  <%- include( 'partials/footer.ejs' ) %>